Media PoC
Демонстрационный Spring Boot-проект для стриминга видео через HTTP Range-запросы и через JWT-защищённые URL.
Включает два способа отдачи видео и динамический плейлист на 5+ роликов.


Упрощённое описание работы приложения
Ниже шаг за шагом рассказывается, что происходит в браузере и на сервере при вводе URL плейлиста.

1. Range-плейлист
   Адрес: http://localhost:8080/range-playlist.html

Вводите в адресную строку http://localhost:8080/range-playlist.html

Браузер запрашивает файл range-playlist.html из static/ и отображает страницу с <video> и встроенным скриптом.

Скрипт выполняет fetch('/media') → MediaController возвращает JSON-массив имён видео.

На основе этого списка JS создаёт массив URL-ов вида /range/media/{имя_файла}.

Устанавливает первый URL в video.src → браузер шлёт GET /range/media/{file} с заголовком Range: bytes=0-….

RangeController парсит заголовок, читает фрагмент нужного файла через VideoStorage и отдаёт 206 Partial Content с байтовым диапазоном.

Браузер начинает воспроизведение, подгружая следующие фрагменты по мере необходимости.

При окончании ролика срабатывает событие ended и скрипт переключает video.src на следующий URL из списка.

2. JWT-плейлист
   Адрес: http://localhost:8080/playlist-jwt.html

Вводите http://localhost:8080/playlist-jwt.html

Браузер загружает страницу playlist-jwt.html с <video> и скриптом для JWT.

Скрипт делает fetch('/media') → получает список имён файлов.

Для каждого имени сначала запрашивает JWT: GET /token/media/{key}/token.

Собирает защищённые URL-ы /token/media/signed/{jwt} в массив.

Устанавливает в video.src первый защищённый URL → браузер с заголовком Range обращается к TokenController.

TokenController проверяет JWT, парсит claim с именем видео, читает запрошенный диапазон и возвращает 206 Partial Content.

Плеер воспроизводит защищённый фрагмент, по окончании ролика скрипт переходит к следующему URL.